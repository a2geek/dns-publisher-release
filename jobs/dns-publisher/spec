---
name: dns-publisher

templates:
  ctl.erb: bin/ctl
  config.json.erb: config/config.json

packages:
- dns-publisher

properties:
  publisher.type:
    description: "Publisher type. Currently supported are: openwrt and fake."
    default: openwrt
  publisher.dry-run:
    description: "Enable dry-run capabilities. Will connect in a read-only manner and only log the writes that would occur. Must be string."
    default: "true"
  publisher.options:
    description: "Configuration options for publsiher type. Example is for openwrt."
    example:
      user: root
      host: 192.168.1.1
      private-key:
        -----BEGIN RSA PRIVATE KEY-----
        <snip>
        -----END RSA PRIVATE KEY-----

  # Native DNS source. A bit heavy handed since it does it by refresh instead of actual change (impacts router).
  source.refresh:
    description: "Refresh rate for the DNS query. This both interrogates/updates the router and BOSH DNS. Uses Go Duration notation."
    default: "5m"
  source.by-query:
    description: "Map of BOSH DNS queries to an array of host names. DO NOT USE WILDCARDS."
    example:
      "q-s3.web.default.concourse.bosh": ["concourse.lan"]
      "q-s3.postgres.default.postgres.bosh": ["postgres.lan"]
      "q-s3.router.default.cf.bosh": ["sys.cf.lan", "app.cf.lan"]
